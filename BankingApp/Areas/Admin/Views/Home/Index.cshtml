@using BankingApp.Core.Application.ViewModels.Dashboards
@model AdminDashboardViewModel

@{
    ViewData["Title"] = "Panel de Administración";
}

<!-- Page Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2 class="mb-1">
                    <i class="bi bi-speedometer2 me-2"></i>Panel de Administración Bancaria
                </h2>
                <p class="text-muted mb-0">Sistema Integral de Gestión Financiera</p>
            </div>
            <div class="text-end">
                <small class="text-muted">Actualizado: @DateTime.Now.ToString("dd/MM/yyyy HH:mm")</small>
            </div>
        </div>
    </div>
</div>

<!-- Estadísticas Principales -->
<div class="row g-4 mb-4">
    <!-- Transacciones -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">TRANSACCIONES TOTALES</div>
                        <div class="stats-value text-primary fw-bold fs-3">@Model.TotalTransactionsCount.ToString("N0")</div>
                        <div class="stats-subtitle text-success small mt-1">
                            <i class="bi bi-arrow-up-short"></i> Hoy: @Model.TodayTransactionsCount.ToString("N0")
                        </div>
                    </div>
                    <div class="stats-icon bg-primary bg-opacity-10 p-3 rounded">
                        <i class="bi bi-arrow-left-right text-primary fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pagos -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">PAGOS PROCESADOS</div>
                        <div class="stats-value text-success fw-bold fs-3">@Model.TotalPaysCount.ToString("N0")</div>
                        <div class="stats-subtitle text-info small mt-1">
                            <i class="bi bi-calendar-day"></i> Diarios: @Model.DayPaysCount.ToString("N0")
                        </div>
                    </div>
                    <div class="stats-icon bg-success bg-opacity-10 p-3 rounded">
                        <i class="bi bi-cash-coin text-success fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Clientes -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">CLIENTES ACTIVOS</div>
                        <div class="stats-value text-info fw-bold fs-3">@Model.TotalActiveClientsCount.ToString("N0")</div>
                        <div class="stats-subtitle text-warning small mt-1">
                            <i class="bi bi-person-x"></i> Inactivos: @Model.TotalInactiveClientsCount.ToString("N0")
                        </div>
                    </div>
                    <div class="stats-icon bg-info bg-opacity-10 p-3 rounded">
                        <i class="bi bi-people text-info fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Productos Asignados -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">PRODUCTOS ASIGNADOS</div>
                        <div class="stats-value text-warning fw-bold fs-3">@Model.TotalAsignedProductsCount.ToString("N0")</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Cuentas, préstamos y tarjetas
                        </div>
                    </div>
                    <div class="stats-icon bg-warning bg-opacity-10 p-3 rounded">
                        <i class="bi bi-briefcase text-warning fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Segunda Fila de Estadísticas -->
<div class="row g-4 mb-4">
    <!-- Préstamos Vigentes -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">PRÉSTAMOS VIGENTES</div>
                        <div class="stats-value text-danger fw-bold fs-3">@Model.TotalCurrentLoansCount.ToString("N0")</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Cartera activa actual
                        </div>
                    </div>
                    <div class="stats-icon bg-danger bg-opacity-10 p-3 rounded">
                        <i class="bi bi-cash-stack text-danger fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tarjetas de Crédito -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">TARJETAS ACTIVAS</div>
                        <div class="stats-value text-purple fw-bold fs-3">@Model.TotalActiveCreditCardsCount.ToString("N0")</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Emitidas: @Model.TotalIssuedCreditCardsCount.ToString("N0")
                        </div>
                    </div>
                    <div class="stats-icon bg-purple bg-opacity-10 p-3 rounded">
                        <i class="bi bi-credit-card text-purple fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cuentas de Ahorro -->
    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="stats-title text-muted small">CUENTAS DE AHORRO</div>
                        <div class="stats-value text-teal fw-bold fs-3">@Model.TotalSavingAccountsCount.ToString("N0")</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Cuentas activas en el sistema
                        </div>
                    </div>
                    <div class="stats-icon bg-teal bg-opacity-10 p-3 rounded">
                        <i class="bi bi-piggy-bank text-teal fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card stats-card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">

                        <div class="stats-title text-muted small">DEUDA PROMEDIO</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Por cliente activo
                        </div>
                        <div class="stats-value text-dark fw-bold fs-2">@Model.AverageClientsDebt.ToString("C2")</div>
                        <div class="stats-subtitle text-muted small mt-1">
                            Por clientes activos e inactivos
                        </div>
                        <div class="stats-value text-dark fw-bold fs-2">@Model.AverageClientsDebtActiveAndInactive.ToString("C2")</div>
                       
                    </div>

                    <div class="stats-icon bg-dark bg-opacity-10 p-3 rounded">
                        <i class="bi bi-graph-up text-dark fs-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">
                    <i class="bi bi-lightning-charge text-warning me-2"></i>Accesos Rápidos
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-lg-3 col-md-6">
                        <a asp-area="Admin" asp-controller="Users" asp-action="Index" class="quick-access-card card border h-100 text-decoration-none">
                            <div class="card-body text-center p-4">
                                <div class="icon-wrapper bg-primary bg-opacity-10 rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                                    <i class="bi bi-people-fill text-primary fs-4"></i>
                                </div>
                                <h6 class="card-title mb-2">Gestión de Usuarios</h6>
                                <p class="text-muted small mb-0">Administrar clientes y empleados</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a asp-area="Admin" asp-controller="Loans" asp-action="Index" class="quick-access-card card border h-100 text-decoration-none">
                            <div class="card-body text-center p-4">
                                <div class="icon-wrapper bg-warning bg-opacity-10 rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                                    <i class="bi bi-cash-stack text-warning fs-4"></i>
                                </div>
                                <h6 class="card-title mb-2">Gestión de Préstamos</h6>
                                <p class="text-muted small mb-0">Aprobar y gestionar préstamos</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a asp-area="Admin" asp-controller="CreditCard" asp-action="Index" class="quick-access-card card border h-100 text-decoration-none">
                            <div class="card-body text-center p-4">
                                <div class="icon-wrapper bg-purple bg-opacity-10 rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                                    <i class="bi bi-credit-card text-purple fs-4"></i>
                                </div>
                                <h6 class="card-title mb-2">Tarjetas de Crédito</h6>
                                <p class="text-muted small mb-0">Emitir y gestionar tarjetas</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a asp-area="Admin" asp-controller="SavingsAccount" asp-action="Index" class="quick-access-card card border h-100 text-decoration-none">
                            <div class="card-body text-center p-4">
                                <div class="icon-wrapper bg-teal bg-opacity-10 rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                                    <i class="bi bi-piggy-bank text-teal fs-4"></i>
                                </div>
                                <h6 class="card-title mb-2">Cuentas de Ahorro</h6>
                                <p class="text-muted small mb-0">Administrar cuentas bancarias</p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Información del Sistema -->
<div class="row">
    <div class="col-lg-8">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">
                    <i class="bi bi-info-circle text-primary me-2"></i>Resumen del Sistema
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle-fill text-success fs-5"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Base de Clientes</h6>
                                <p class="text-muted mb-0 small">@Model.TotalActiveClientsCount clientes activos gestionando sus productos financieros</p>
                            </div>
                        </div>
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle-fill text-success fs-5"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Operaciones Diarias</h6>
                                <p class="text-muted mb-0 small">@Model.DayPaysCount transacciones procesadas hoy</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle-fill text-success fs-5"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Cartera de Préstamos</h6>
                                <p class="text-muted mb-0 small">@Model.TotalCurrentLoansCount préstamos activos en cartera</p>
                            </div>
                        </div>
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle-fill text-success fs-5"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Productos Activos</h6>
                                <p class="text-muted mb-0 small">@Model.TotalAsignedProductsCount productos financieros asignados</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">
                    <i class="bi bi-exclamation-triangle text-warning me-2"></i>Alertas del Sistema
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning border-0 mb-3" role="alert">
                    <div class="d-flex">
                        <i class="bi bi-shield-check me-2"></i>
                        <div>
                            <strong>Verificación de Identidad</strong>
                            <p class="mb-0 small">Confirme la identidad antes de operaciones sensibles</p>
                        </div>
                    </div>
                </div>
                <div class="alert alert-info border-0 mb-0" role="alert">
                    <div class="d-flex">
                        <i class="bi bi-graph-up me-2"></i>
                        <div>
                            <strong>Rendimiento del Sistema</strong>
                            <p class="mb-0 small">@Model.TotalTransactionsCount transacciones históricas procesadas</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --primary: #3A6EA5;        
        --primary-light: #E8F1FB; 
        --secondary: #FFC837;     
        --secondary-light: #FFF4D9;
        --neutral-dark: #2E3A45;
        --neutral: #6C757D;
        --neutral-light: #F5F7FA;
        --border-light: #E2E6EA;
    }

    body {
        background-color: var(--neutral-light);
        color: var(--neutral-dark);
        font-family: "Segoe UI", sans-serif;
    }

    /* Tarjetas de estadísticas */
    .stats-card {
        background: white;
        border-radius: 10px;
        border: 1px solid var(--border-light);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .stats-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }

    .stats-title {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        color: var(--neutral);
        letter-spacing: 0.4px;
    }

    .stats-value {
        font-weight: 700;
        font-size: 1.9rem;
        color: var(--primary);
    }

    .stats-subtitle {
        font-size: 0.80rem;
        color: var(--neutral);
    }

    /* Íconos de tarjetas */
    .stats-icon {
        background: var(--primary-light);
        border-radius: 12px;
        padding: 0.85rem 1rem;
    }

    .stats-icon i {
        color: var(--primary) !important;
    }

    /* Accesos rápidos */
    .quick-access-card {
        border: 1px solid var(--border-light);
        border-radius: 10px;
        background: white;
        transition: all 0.25s ease;
    }

    .quick-access-card:hover {
        border-color: var(--primary);
        background: var(--primary-light);
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(58,110,165,0.12);
    }

    .icon-wrapper {
        background: var(--primary-light);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex; 
        align-items: center; 
        justify-content:center;
        transition: 0.25s ease;
    }

    .quick-access-card:hover .icon-wrapper {
        background: var(--secondary-light);
        transform: scale(1.07);
    }

    /* Alertas más suaves, estilo institucional */
    .alert-warning {
        background: var(--secondary-light);
        border-left: 4px solid var(--secondary);
    }

    .alert-info {
        background: var(--primary-light);
        border-left: 4px solid var(--primary);
    }

    .card {
        border: 1px solid var(--border-light) !important;
        border-radius: 10px;
    }

    .card-header {
        background: white !important;
        border-bottom: 1px solid var(--border-light) !important;
        font-weight: 600;
        color: var(--neutral-dark);
    }
</style>